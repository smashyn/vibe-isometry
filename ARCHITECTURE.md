# Архітектура проєкту

## Основні компоненти

### 1. UserManager

- Відповідає за реєстрацію, аутентифікацію, видачу та перевірку токенів.
- Зберігає інформацію про користувачів, їх токени, дату дії токена.

### 2. CharacterManager

- Операції над персонажами: створення, оновлення, видалення.
- Перевіряє токен користувача через UserManager.
- Один користувач може мати багато персонажів, але лише один активний.

### 3. PlayerManager

- Зберігає інформацію про користувачів у грі (UserData).
- UserData містить: id, username, token, список персонажів, activeCharacterId, activeRoom.
- Дозволяє керувати активним персонажем та активною кімнатою користувача.

### 4. RoomManager

- Зберігає всі кімнати (Room).
- Room: id, name, admin, players[], status (ACTIVE, GAME, INACTIVE).
- Адмін може редагувати/видаляти кімнату.
- Користувач може приєднатись/вийти з кімнати.
- При створенні/приєднанні/видаленні/зміні статусу кімнати оновлюється activeRoom у UserData.

### 5. WebSocket (WSMessageHandler)

- Зберігає всі підключення (allClients).
- Розсилає оновлений список кімнат усім клієнтам при змінах.
- Всі події (створення, редагування, видалення, приєднання, вихід з кімнати) обробляються окремими хендлерами.

---

## Взаємодія

- Користувач логіниться через REST, отримує токен.
- Підключення до WebSocket можливе лише з валідним токеном.
- Кімнати мають статус (ACTIVE, GAME, INACTIVE).
- При зміні статусу на GAME всім гравцям кімнати встановлюється activeRoom.
- При видаленні кімнати activeRoom очищується у всіх гравців цієї кімнати.
- При виході з кімнати activeRoom очищується у користувача.

---

## Розширення

- Архітектура дозволяє легко додавати нові типи подій, статуси кімнат, розширювати UserData та Room.
- Дані про користувачів і кімнати зберігаються у памʼяті (можна винести у БД).

---

**Цей файл можна оновлювати при зміні архітектури.**
